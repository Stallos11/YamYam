import{u as R}from"./ticket-bb520c98.js";import{d as b,u as C,G as L,r as f,y as g,l as E,C as V,o as l,c as i,a as e,t as o,f as s,F as B,x as F,z,b as d,w as h,m as N,j as _}from"./index-1f826056.js";const j={class:"container"},A={class:"d-flex vcenter"},G={class:"w100"},H={class:"d-flex"},I={class:""},M={class:"ml-auto"},U={class:"grey dark-1 p-3 rounded-2 my-2 light-shadow-2 ml-5"},q={class:"text-right font-s1 mb-0"},J={class:"text-right font-s1 mb-0"},K={class:"my-5"},W=b({__name:"TicketDetails",setup(O){const t=R(),v=C(),k=L(),u=N(),n=f(""),r=f(),x=g(()=>t.selectedTicket.status==="in progress"?"En cours":"Fermé");E(()=>{t.getTicket(u.params.id),t.getTicketResponses(u.params.id)});const T=async()=>{if(n.value.length<2){k.setError("Invalid response");return}await t.insertResponse(n.value)},y=g(()=>t.selectedTicketResponses);return V(y,(m,c)=>{m.length!==c.length&&setTimeout(()=>{r.value.scrollTop=r.value.scrollHeight,n.value=""},100)}),(m,c)=>{const w=_("ax-form-control"),S=_("ax-form-field"),D=_("ax-form");return l(),i("div",j,[e("div",A,[e("div",G,[e("h2",null,o(s(t).selectedTicket.title),1),e("div",H,[e("p",I,o(s(x)),1),e("p",M,o(new Date(s(t).selectedTicket.created_at).toLocaleDateString()),1)])])]),e("div",{ref_key:"conv",ref:r,class:"conv px-2"},[e("div",U,[e("p",null,o(s(t).selectedTicket.message),1),e("p",q,o(new Date(s(t).selectedTicket.created_at).toLocaleTimeString()+" "+new Date(s(t).selectedTicket.created_at).toLocaleDateString()),1)]),(l(!0),i(B,null,F(s(t).selectedTicketResponses,a=>{var p;return l(),i("div",{class:z([a.user_id==((p=s(v).user)==null?void 0:p.id)?"ml-5 grey dark-1":"mr-5 grey dark-4","p-3 rounded-2 my-2 light-shadow-2"])},[e("p",null,o(a.message),1),e("p",J,o(new Date(a.created_at).toLocaleTimeString()+" "+new Date(a.created_at).toLocaleDateString()),1)],2)}),256))],512),e("div",K,[d(D,null,{default:h(()=>[d(S,{label:"Réponse"},{default:h(()=>[d(w,{modelValue:n.value,"onUpdate:modelValue":c[0]||(c[0]=a=>n.value=a),tag:"textarea"},null,8,["modelValue"])]),_:1})]),_:1}),e("button",{onClick:T,class:"btn primary rounded-2 px-4 py-1"},"Envoyer")])])}}});export{W as default};
