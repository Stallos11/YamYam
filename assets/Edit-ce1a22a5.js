import{_ as G,a as M,b as j}from"./IngredientSearchTable.vue_vue_type_style_index_0_lang-9ef3df05.js";import{d as T,v as w,r as C,m as H,f as o,o as _,c as g,b as e,w as d,a as t,j as u,F as S,x as R,t as y,e as h,y as N,H as J,z as k,I as Q,s as q,k as K}from"./index-696d35e5.js";import{u as A,a as F}from"./recipeCategories-4f814aba.js";const W={key:0,class:"d-flex h100"},X={class:"grix xs1 md2 gutter-xs5"},Y=t("label",null,"Preparation Time",-1),Z=t("label",null,"Cooking Time",-1),ee={key:1,class:"h100 d-flex vcenter fx-center"},te=T({__name:"GeneralTab",setup(I){const l=w(),s=A(),E=F(),V=C(),c=C();C("");const b=C(["1","2","3","4","5"]);H(()=>{E.fetchData().then(r=>{c.value=E.recipe_categories.map(a=>({name:a.category,value:a.id,disabled:!1,selected:!1}))}),s.fetchData().then(r=>{V.value=s.recipe_types.map(a=>({name:a.type,value:a.id,disabled:!1,selected:!1}))})});const f=r=>{const a=r.target.files[0];if(a!=null&&l.recipeEdit.id){l.recipeEdit.image=a;const i=new FileReader;i.readAsBinaryString(a),i.onload=function(){i.result.length&&(l.recipeEdit.previewImage=btoa(i.result))},i.onerror=function(){console.log("there are some problems")}}};return(r,a)=>{const i=u("ax-form-control"),n=u("ax-form-field"),v=u("VueTimepicker"),x=u("ax-form-select"),p=u("ax-form-file"),U=u("ax-form"),O=u("Icon");return o(l).isLoading?(_(),g("div",ee,[e(O,{icon:"eos-icons:bubble-loading",width:"40",class:"text-white"})])):(_(),g("div",W,[e(U,{class:"w100"},{default:d(()=>[t("div",X,[e(n,{class:"col-md2 col-xs1",label:"Recipe name"},{default:d(()=>[e(i,{tag:"input",modelValue:o(l).recipeEdit.name,"onUpdate:modelValue":a[0]||(a[0]=m=>o(l).recipeEdit.name=m),type:"text"},null,8,["modelValue"])]),_:1}),e(n,{class:"col-md2 col-xs1",label:"Description"},{default:d(()=>[e(i,{modelValue:o(l).recipeEdit.description,"onUpdate:modelValue":a[1]||(a[1]=m=>o(l).recipeEdit.description=m),tag:"textarea"},null,8,["modelValue"])]),_:1}),e(n,null,{default:d(()=>[Y,e(v,{class:"time-control","close-on-complete":"",modelValue:o(l).recipeEdit.preparation_time,"onUpdate:modelValue":a[2]||(a[2]=m=>o(l).recipeEdit.preparation_time=m),"minute-interval":5},null,8,["modelValue"])]),_:1}),e(n,null,{default:d(()=>[Z,e(v,{class:"time-control","close-on-complete":"",modelValue:o(l).recipeEdit.cooking_time,"onUpdate:modelValue":a[3]||(a[3]=m=>o(l).recipeEdit.cooking_time=m),"minute-interval":5},null,8,["modelValue"])]),_:1}),t("div",null,[e(n,{label:"Dificulty"},{default:d(()=>[e(x,{items:b.value,modelValue:o(l).recipeEdit.difficulty,"onUpdate:modelValue":a[4]||(a[4]=m=>o(l).recipeEdit.difficulty=m)},null,8,["items","modelValue"])]),_:1})]),t("div",null,[e(n,{label:"Eaters amount"},{default:d(()=>[e(i,{tag:"input",modelValue:o(l).recipeEdit.eaters_amount,"onUpdate:modelValue":a[5]||(a[5]=m=>o(l).recipeEdit.eaters_amount=m),type:"number",min:"0"},null,8,["modelValue"])]),_:1})]),t("div",null,[e(n,{label:"Catégorie"},{default:d(()=>[e(x,{items:c.value,modelValue:o(l).recipeEdit.recipe_category_id,"onUpdate:modelValue":a[6]||(a[6]=m=>o(l).recipeEdit.recipe_category_id=m)},null,8,["items","modelValue"])]),_:1})]),t("div",null,[e(n,{label:"Type"},{default:d(()=>[e(x,{items:V.value,modelValue:o(l).recipeEdit.recipe_type_id,"onUpdate:modelValue":a[7]||(a[7]=m=>o(l).recipeEdit.recipe_type_id=m)},null,8,["items","modelValue"])]),_:1})]),t("div",null,[e(p,{label:"Upload",onChange:f,"label-classes":"btn airforce dark-1 rounded-1"})])])]),_:1})]))}}}),ne={class:"grix xs1 lg2 gutter-xs3"},oe=t("p",{class:"font-s4 mt-0 bd-b-solid bd-white bd-2 pb-2"},"Ingredient list",-1),ie={class:"grix xs4 gutter-xs3 vcenter center"},se=["href"],le=["src"],ae=T({__name:"IngredientTab",setup(I){const l=w(),s=["mg","g","kg","mL","cL","L"],E=V=>{l.recipeEdit.ingredients=l.recipeEdit.ingredients.filter(c=>c.id!=V)};return(V,c)=>{const b=u("ax-form-control"),f=u("ax-form-field"),r=u("ax-form-select"),a=u("Icon"),i=u("ax-btn");return _(),g("div",ne,[t("div",null,[oe,(_(!0),g(S,null,R(o(l).recipeEdit.ingredients,(n,v)=>(_(),g("div",{key:n.id,class:"grix xs1 gutter-xs3 vcenter"},[t("p",null,y(n.product_name),1),t("div",ie,[t("a",{target:"_blank",href:`https://fr.openfoodfacts.org/produit/${n.openfoodfact_id}`},[t("img",{class:"rounded-2 ingredient-img",src:n.img},null,8,le)],8,se),e(f,{label:"Qty"},{default:d(()=>[e(b,{min:"1",tag:"input",modelValue:n.amount,"onUpdate:modelValue":x=>n.amount=x,type:"number"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(f,{label:"Unit"},{default:d(()=>[e(r,{items:s,modelValue:n.unit,"onUpdate:modelValue":x=>n.unit=x},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(i,{onClick:x=>E(n.id),circle:"",small:"",class:"red d-flex vcenter fx-center"},{default:d(()=>[e(a,{icon:"clarity:times-line",width:"20"})]),_:2},1032,["onClick"])])]))),128))]),t("div",null,[e(G),e(M)])])}}}),re={class:"grix xs1 lg2 gutter-xs3"},de=t("p",{class:"font-s4 bd-b-solid bd-2 bd-white pb-2 mt-0"},"Instructions",-1),ce={class:"d-flex fx-col mb-5"},pe={class:"p-4"},ue=T({__name:"PreparationTab",setup(I){const l=w(),s=C({title:"",description:""}),E=()=>{s.value.title=s.value.title.trim(),s.value.description=s.value.description.trim(),!(!s.value.title.length||!s.value.description.length)&&(l.addInstructionToEditRecipe(s.value),s.value={title:"",description:""})},V=c=>{l.recipeEdit.instructions.splice(c,1)};return(c,b)=>{const f=u("ax-form-control"),r=u("ax-form-field"),a=u("ax-btn");return _(),g("div",re,[t("div",null,[de,(_(!0),g(S,null,R(o(l).recipeEdit.instructions,(i,n)=>(_(),g("div",ce,[e(r,{label:"Titre"},{default:d(()=>[e(f,{tag:"input",modelValue:i.title,"onUpdate:modelValue":v=>i.title=v,type:"text"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(r,{label:"Description"},{default:d(()=>[e(f,{tag:"textarea",modelValue:i.description,"onUpdate:modelValue":v=>i.description=v,type:"text"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(a,{onClick:v=>V(n),class:"red font-s2 d-block ml-auto rounded-3 px-5 py-1"},{default:d(()=>[h(" DELETE ")]),_:2},1032,["onClick"])]))),256))]),t("div",pe,[e(r,{label:"Titre"},{default:d(()=>[e(f,{tag:"input",modelValue:s.value.title,"onUpdate:modelValue":b[0]||(b[0]=i=>s.value.title=i),type:"text"},null,8,["modelValue"])]),_:1}),e(r,{label:"Description"},{default:d(()=>[e(f,{tag:"textarea",modelValue:s.value.description,"onUpdate:modelValue":b[1]||(b[1]=i=>s.value.description=i),type:"text"},null,8,["modelValue"])]),_:1}),e(a,{disabled:!s.value.title.length||!s.value.description.length,onClick:b[2]||(b[2]=i=>E()),class:"btn my-5 primary rounded-3 px-5 py-2 text-white d-block mx-auto"},{default:d(()=>[h("AJOUTER")]),_:1},8,["disabled"])])])}}}),me={class:"p-4 grix xs1 lg2 gutter-xs4"},_e={class:"font-s5"},fe={class:"grix xs2 md12 gutter-xs5 font-s3 mt-4"},xe={class:"d-flex vcenter"},ge={class:"d-flex vcenter"},be={class:"d-flex vcenter"},ve={class:"d-flex vcenter"},ye={class:"pb-5"},ke=t("p",{class:"font-s3 mt-5 text-secondary"},"Ingrédients",-1),Ve=t("div",{class:"divider white"},null,-1),Ee={class:"mb-0"},he={class:"mt-0"},$e=t("p",{class:"font-s3 mt-5 text-secondary"},"Instructions",-1),Ce=t("div",{class:"divider white"},null,-1),Te={class:"mt-5"},Ie={class:"mb-0 font-s"},we={class:"mt-1"},Ue={class:"d-flex fx-col px-4"},Oe={key:0,class:"font-s7"},Se={key:1,class:"font-s7"},Re=T({__name:"PreviewTab",emits:["switchTab"],setup(I,{emit:l}){const s=w(),E=A(),V=F(),c=i=>{l("switchTab",i)},b=N(()=>{var i;return(i=V.recipe_categories.find(n=>n.id===s.recipeEdit.recipe_category_id))==null?void 0:i.category}),f=N(()=>{var i;return(i=E.recipe_types.find(n=>n.id===s.recipeEdit.recipe_type_id))==null?void 0:i.type}),r=N(()=>{const i=s.recipeEdit,n=!!i.name.length,v=!!i.description.length,x=!!i.preparation_time.length,p=!!i.cooking_time.length,U=!!i.difficulty,O=!!i.eaters_amount&&i.eaters_amount>0,m=!!i.recipe_category_id.length,L=!!i.recipe_type_id.length,D=!!i.ingredients.length,P=D&&i.ingredients.every($=>!!($.amount&&$.unit)),B=!!i.instructions.length,z=B&&i.instructions.every($=>!(!$.title.trim().length||!$.description.trim().length||!$.title.length||!$.description.length));return{recipeNameOk:n,recipeDescriptionOk:v,recipePreparationTimeOk:x,recipeCookingTimeOk:p,difficultyOk:U,eatersAmountOk:O,categoryOk:m,typeOk:L,ingredientsNotEmpty:D,ingredientsOk:P,instructionsNotEmpty:B,instructionsOk:z,isValid:n&&v&&x&&p&&U&&O&&m&&L&&D&&P&&z}}),a=()=>{r.value.isValid&&s.update()};return(i,n)=>{const v=u("ax-btn"),x=u("Icon");return _(),g("div",me,[t("div",null,[t("p",_e,y(o(s).recipeEdit.name||"No name"),1),t("div",{class:"rounded-2 my-5",style:J([{"min-height":"12rem","background-size":"cover","background-position":"center"},`background-image: url('data:image/png;base64, ${o(s).recipeEdit.previewImage||o(s).recipeEdit.image}')`])},null,4),t("div",null,[e(v,{class:"btn primary px-4 py-1 rounded-3 font-s2 mr-3 mb-3"},{default:d(()=>[h(y(o(b)||"empty cat"),1)]),_:1}),e(v,{class:"btn tertiary px-4 py-1 rounded-3 font-s2"},{default:d(()=>[h(y(o(f)||"empty type"),1)]),_:1})]),t("div",fe,[t("div",xe,[e(x,{icon:"ic:outline-access-time",class:"mr-2 text-secondary"}),t("span",null,y(o(s).recipeEdit.preparation_time),1)]),t("div",ge,[e(x,{icon:"icon-park-outline:cook",class:"mr-2 text-secondary"}),t("span",null,y(o(s).recipeEdit.cooking_time),1)]),t("div",be,[e(x,{icon:"mdi:flame",class:"mr-2 text-secondary"}),t("span",null,y(o(s).recipeEdit.difficulty),1)]),t("div",ve,[e(x,{icon:"mdi:users-group",class:"mr-2 text-secondary"}),t("span",null,y(o(s).recipeEdit.eaters_amount),1)])]),t("p",ye,y(o(s).recipeEdit.description),1),ke,Ve,(_(!0),g(S,null,R(o(s).recipeEdit.ingredients,p=>(_(),g("div",{key:p.id,class:"mt-5"},[t("p",Ee,y(p.product_name),1),t("p",he,[t("span",null,y(p.amount),1),t("span",null,y(p.unit),1)])]))),128)),$e,Ce,(_(!0),g(S,null,R(o(s).recipeEdit.instructions,p=>(_(),g("div",Te,[t("p",Ie,y(p.title),1),t("p",we,y(p.description),1)]))),256)),e(v,{disabled:!o(r).isValid,onClick:a,class:"mt-3 d-block mx-auto rounded-2 primary rounded-3 px-4 py-1"},{default:d(()=>[h("Validate")]),_:1},8,["disabled"])]),t("div",Ue,[t("p",{class:k(["font-s4",o(r).isValid?"text-green":"text-red"])},[h(" Recipe "+y(o(r).isValid?"valid":"invalid")+" ",1),o(r).isValid?(_(),g("span",Oe,"👌")):(_(),g("span",Se,"🥲"))],2),t("p",{class:k(["cursor-pointer mb-0",o(r).recipeNameOk?"text-green":"text-red"]),onClick:n[0]||(n[0]=p=>c("tab1"))},"Name",2),t("p",{class:k(["cursor-pointer mb-0",o(r).recipeDescriptionOk?"text-green":"text-red"]),onClick:n[1]||(n[1]=p=>c("tab1"))},"Description",2),t("p",{class:k(["cursor-pointer mb-0",o(r).recipePreparationTimeOk?"text-green":"text-red"]),onClick:n[2]||(n[2]=p=>c("tab1"))},"Preparation time",2),t("p",{class:k(["cursor-pointer mb-0",o(r).recipeCookingTimeOk?"text-green":"text-red"]),onClick:n[3]||(n[3]=p=>c("tab1"))},"Cooking time",2),t("p",{class:k(["cursor-pointer mb-0",o(r).difficultyOk?"text-green":"text-red"]),onClick:n[4]||(n[4]=p=>c("tab1"))},"Difficulty",2),t("p",{class:k(["cursor-pointer mb-0",o(r).eatersAmountOk?"text-green":"text-red"]),onClick:n[5]||(n[5]=p=>c("tab1"))},"Eaters amount",2),t("p",{class:k(["cursor-pointer mb-0",o(r).categoryOk?"text-green":"text-red"]),onClick:n[6]||(n[6]=p=>c("tab1"))},"Category",2),t("p",{class:k(["cursor-pointer mb-0",o(r).typeOk?"text-green":"text-red"]),onClick:n[7]||(n[7]=p=>c("tab1"))},"Type",2),t("p",{class:k(["cursor-pointer mb-0",o(r).ingredientsNotEmpty?"text-green":"text-red"]),onClick:n[8]||(n[8]=p=>c("tab2"))},"Ingredients amount / unit",2),t("p",{class:k(["cursor-pointer mb-0",o(r).ingredientsOk?"text-green":"text-red"]),onClick:n[9]||(n[9]=p=>c("tab2"))},"Ingredients valid",2),t("p",{class:k(["cursor-pointer mb-0",o(r).instructionsNotEmpty?"text-green":"text-red"]),onClick:n[10]||(n[10]=p=>c("tab3"))},"Instructions not empty",2),t("p",{class:k(["cursor-pointer mb-0",o(r).instructionsOk?"text-green":"text-red"]),onClick:n[11]||(n[11]=p=>c("tab3"))},"Instructions valid",2)])])}}}),De=T({__name:"RecipeEdit",setup(I){const l=C(),s=w(),E=K(),V=c=>{l.value=c};return Q(async()=>{s.recipeEdit.id||await s.editRecipe(E.params.id)}),(c,b)=>{const f=u("ax-tab-link"),r=u("ax-tab-item"),a=u("ax-tab");return _(),q(a,{modelValue:l.value,"onUpdate:modelValue":b[0]||(b[0]=i=>l.value=i),class:"shadow-1 h100 px-5 pt-2"},{menu:d(()=>[e(f,{href:"#tab1"},{default:d(()=>[h("General")]),_:1}),e(f,{href:"#tab2"},{default:d(()=>[h("Ingredients")]),_:1}),e(f,{href:"#tab3"},{default:d(()=>[h("Instructions")]),_:1}),e(f,{href:"#tab4"},{default:d(()=>[h("Preview")]),_:1})]),default:d(()=>[e(r,{class:"h100 pt-5",id:"tab1"},{default:d(()=>[e(te)]),_:1}),e(r,{class:"h100 pt-5",id:"tab2"},{default:d(()=>[e(ae)]),_:1}),e(r,{class:"h100 pt-5",id:"tab3"},{default:d(()=>[e(ue)]),_:1}),e(r,{class:"h100 pt-5",id:"tab4"},{default:d(()=>[e(Re,{onSwitchTab:V})]),_:1}),e(j,{type:"edit"})]),_:1},8,["modelValue"])}}});const Ne={class:"h100"},Ae=T({__name:"Edit",setup(I){return(l,s)=>(_(),g("div",Ne,[e(De)]))}});export{Ae as default};
