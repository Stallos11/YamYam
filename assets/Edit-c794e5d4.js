import{_ as M,a as G,b as j}from"./IngredientSearchTable.vue_vue_type_style_index_0_lang-8e1eabf5.js";import{d as C,v as w,r as T,l as q,f as o,o as _,c as b,b as e,w as d,a as t,j as u,F as S,x as R,t as y,e as h,y as D,I as J,z as k,E as Q,s as H,m as K}from"./index-5dc890c6.js";import{u as z,a as F}from"./recipeCategories-40d67e41.js";const W={key:0,class:"d-flex h100"},X={class:"grix xs1 md2 gutter-xs5"},Y=t("label",null,"Tps de préparation",-1),Z=t("label",null,"Tps de cuisson",-1),ee={key:1,class:"h100 d-flex vcenter fx-center"},te=C({__name:"GeneralTab",setup(I){const l=w(),s=z(),E=F(),V=T(),c=T();T("");const g=T(["1","2","3","4","5"]);q(()=>{E.fetchData().then(a=>{c.value=E.recipe_categories.map(r=>({name:r.category,value:r.id,disabled:!1,selected:!1}))}),s.fetchData().then(a=>{V.value=s.recipe_types.map(r=>({name:r.type,value:r.id,disabled:!1,selected:!1}))})});const f=a=>{const r=a.target.files[0];if(r!=null&&l.recipeEdit.id){l.recipeEdit.image=r;const i=new FileReader;i.readAsBinaryString(r),i.onload=function(){i.result.length&&(l.recipeEdit.previewImage=btoa(i.result))},i.onerror=function(){console.log("there are some problems")}}};return(a,r)=>{const i=u("ax-form-control"),n=u("ax-form-field"),v=u("VueTimepicker"),x=u("ax-form-select"),p=u("ax-form-file"),U=u("ax-form"),O=u("Icon");return o(l).isLoading?(_(),b("div",ee,[e(O,{icon:"eos-icons:bubble-loading",width:"40",class:"text-white"})])):(_(),b("div",W,[e(U,{class:"w100"},{default:d(()=>[t("div",X,[e(n,{class:"col-md2 col-xs1",label:"Nom"},{default:d(()=>[e(i,{tag:"input",modelValue:o(l).recipeEdit.name,"onUpdate:modelValue":r[0]||(r[0]=m=>o(l).recipeEdit.name=m),type:"text"},null,8,["modelValue"])]),_:1}),e(n,{class:"col-md2 col-xs1",label:"Description"},{default:d(()=>[e(i,{modelValue:o(l).recipeEdit.description,"onUpdate:modelValue":r[1]||(r[1]=m=>o(l).recipeEdit.description=m),tag:"textarea"},null,8,["modelValue"])]),_:1}),e(n,null,{default:d(()=>[Y,e(v,{class:"time-control w100","close-on-complete":"",modelValue:o(l).recipeEdit.preparation_time,"onUpdate:modelValue":r[2]||(r[2]=m=>o(l).recipeEdit.preparation_time=m),"minute-interval":5},null,8,["modelValue"])]),_:1}),e(n,null,{default:d(()=>[Z,e(v,{class:"time-control w100","close-on-complete":"",modelValue:o(l).recipeEdit.cooking_time,"onUpdate:modelValue":r[3]||(r[3]=m=>o(l).recipeEdit.cooking_time=m),"minute-interval":5},null,8,["modelValue"])]),_:1}),t("div",null,[e(n,{label:"Dificulté"},{default:d(()=>[e(x,{items:g.value,modelValue:o(l).recipeEdit.difficulty,"onUpdate:modelValue":r[4]||(r[4]=m=>o(l).recipeEdit.difficulty=m)},null,8,["items","modelValue"])]),_:1})]),t("div",null,[e(n,{label:"Nbr de personnes"},{default:d(()=>[e(i,{tag:"input",modelValue:o(l).recipeEdit.eaters_amount,"onUpdate:modelValue":r[5]||(r[5]=m=>o(l).recipeEdit.eaters_amount=m),type:"number",min:"0"},null,8,["modelValue"])]),_:1})]),t("div",null,[e(n,{label:"Catégorie"},{default:d(()=>[e(x,{items:c.value,modelValue:o(l).recipeEdit.recipe_category_id,"onUpdate:modelValue":r[6]||(r[6]=m=>o(l).recipeEdit.recipe_category_id=m)},null,8,["items","modelValue"])]),_:1})]),t("div",null,[e(n,{label:"Type"},{default:d(()=>[e(x,{items:V.value,modelValue:o(l).recipeEdit.recipe_type_id,"onUpdate:modelValue":r[7]||(r[7]=m=>o(l).recipeEdit.recipe_type_id=m)},null,8,["items","modelValue"])]),_:1})]),t("div",null,[e(p,{label:"Image",onChange:f,"label-classes":"btn airforce dark-1 rounded-1"})])])]),_:1})]))}}}),ne={class:"grix xs1 lg2 gutter-xs3"},oe=t("p",{class:"font-s4 mt-0 bd-b-solid bd-white bd-2 pb-2"},"Liste d'ingrédients",-1),ie={class:"grix xs4 gutter-xs3 vcenter center"},se=["href"],le=["src"],re=C({__name:"IngredientTab",setup(I){const l=w(),s=["mg","g","kg","mL","cL","L"],E=V=>{l.recipeEdit.ingredients=l.recipeEdit.ingredients.filter(c=>c.id!=V)};return(V,c)=>{const g=u("ax-form-control"),f=u("ax-form-field"),a=u("ax-form-select"),r=u("Icon"),i=u("ax-btn");return _(),b("div",ne,[t("div",null,[oe,(_(!0),b(S,null,R(o(l).recipeEdit.ingredients,(n,v)=>(_(),b("div",{key:n.id,class:"grix xs1 gutter-xs3 vcenter"},[t("p",null,y(n.product_name),1),t("div",ie,[t("a",{target:"_blank",href:`https://fr.openfoodfacts.org/produit/${n.openfoodfact_id}`},[t("img",{class:"rounded-2 ingredient-img",src:n.img},null,8,le)],8,se),e(f,{label:"Qté"},{default:d(()=>[e(g,{min:"1",tag:"input",modelValue:n.amount,"onUpdate:modelValue":x=>n.amount=x,type:"number"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(f,{label:"Unité"},{default:d(()=>[e(a,{items:s,modelValue:n.unit,"onUpdate:modelValue":x=>n.unit=x},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(i,{onClick:x=>E(n.id),circle:"",small:"",class:"red d-flex vcenter fx-center"},{default:d(()=>[e(r,{icon:"clarity:times-line",width:"20"})]),_:2},1032,["onClick"])])]))),128))]),t("div",null,[e(M),e(G)])])}}}),ae={class:"grix xs1 lg2 gutter-xs3"},de=t("p",{class:"font-s4 bd-b-solid bd-2 bd-white pb-2 mt-0"},"Instructions",-1),ce={class:"d-flex fx-col mb-5"},pe={class:"p-4"},ue=C({__name:"PreparationTab",setup(I){const l=w(),s=T({title:"",description:""}),E=()=>{s.value.title=s.value.title.trim(),s.value.description=s.value.description.trim(),!(!s.value.title.length||!s.value.description.length)&&(l.addInstructionToEditRecipe(s.value),s.value={title:"",description:""})},V=c=>{l.recipeEdit.instructions.splice(c,1)};return(c,g)=>{const f=u("ax-form-control"),a=u("ax-form-field"),r=u("ax-btn");return _(),b("div",ae,[t("div",null,[de,(_(!0),b(S,null,R(o(l).recipeEdit.instructions,(i,n)=>(_(),b("div",ce,[e(a,{label:"Titre"},{default:d(()=>[e(f,{tag:"input",modelValue:i.title,"onUpdate:modelValue":v=>i.title=v,type:"text"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(a,{label:"Description"},{default:d(()=>[e(f,{tag:"textarea",modelValue:i.description,"onUpdate:modelValue":v=>i.description=v,type:"text"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(r,{onClick:v=>V(n),class:"red font-s2 d-block ml-auto rounded-3 px-5 py-1"},{default:d(()=>[h(" SUPPRIMER ")]),_:2},1032,["onClick"])]))),256))]),t("div",pe,[e(a,{label:"Titre"},{default:d(()=>[e(f,{tag:"input",modelValue:s.value.title,"onUpdate:modelValue":g[0]||(g[0]=i=>s.value.title=i),type:"text"},null,8,["modelValue"])]),_:1}),e(a,{label:"Description"},{default:d(()=>[e(f,{tag:"textarea",modelValue:s.value.description,"onUpdate:modelValue":g[1]||(g[1]=i=>s.value.description=i),type:"text"},null,8,["modelValue"])]),_:1}),e(r,{disabled:!s.value.title.length||!s.value.description.length,onClick:g[2]||(g[2]=i=>E()),class:"btn my-5 primary rounded-3 px-5 py-2 text-white d-block mx-auto"},{default:d(()=>[h("AJOUTER")]),_:1},8,["disabled"])])])}}}),me={class:"p-4 grix xs1 lg2 gutter-xs4"},_e={class:"font-s5"},fe={class:"grix xs2 md12 gutter-xs5 font-s3 mt-4"},xe={class:"d-flex vcenter"},be={class:"d-flex vcenter"},ge={class:"d-flex vcenter"},ve={class:"d-flex vcenter"},ye={class:"pb-5"},ke=t("p",{class:"font-s3 mt-5 text-secondary"},"Ingrédients",-1),Ve=t("div",{class:"divider white"},null,-1),Ee={class:"mb-0"},he={class:"mt-0"},$e=t("p",{class:"font-s3 mt-5 text-secondary"},"Instructions",-1),Te=t("div",{class:"divider white"},null,-1),Ce={class:"mt-5"},Ie={class:"mb-0 font-s"},we={class:"mt-1"},Ue={class:"d-flex fx-col px-4"},Oe={key:0,class:"font-s7"},Se={key:1,class:"font-s7"},Re=C({__name:"PreviewTab",emits:["switchTab"],setup(I,{emit:l}){const s=w(),E=z(),V=F(),c=i=>{l("switchTab",i)},g=D(()=>{var i;return(i=V.recipe_categories.find(n=>n.id===s.recipeEdit.recipe_category_id))==null?void 0:i.category}),f=D(()=>{var i;return(i=E.recipe_types.find(n=>n.id===s.recipeEdit.recipe_type_id))==null?void 0:i.type}),a=D(()=>{const i=s.recipeEdit,n=!!i.name.length,v=!!i.description.length,x=!!i.preparation_time.length,p=!!i.cooking_time.length,U=!!i.difficulty,O=!!i.eaters_amount&&i.eaters_amount>0,m=!!i.recipe_category_id.length,P=!!i.recipe_type_id.length,N=!!i.ingredients.length,L=N&&i.ingredients.every($=>!!($.amount&&$.unit)),B=!!i.instructions.length,A=B&&i.instructions.every($=>!(!$.title.trim().length||!$.description.trim().length||!$.title.length||!$.description.length));return{recipeNameOk:n,recipeDescriptionOk:v,recipePreparationTimeOk:x,recipeCookingTimeOk:p,difficultyOk:U,eatersAmountOk:O,categoryOk:m,typeOk:P,ingredientsNotEmpty:N,ingredientsOk:L,instructionsNotEmpty:B,instructionsOk:A,isValid:n&&v&&x&&p&&U&&O&&m&&P&&N&&L&&A}}),r=()=>{a.value.isValid&&s.update()};return(i,n)=>{const v=u("ax-btn"),x=u("Icon");return _(),b("div",me,[t("div",null,[t("p",_e,y(o(s).recipeEdit.name||"Pas de nom"),1),t("div",{class:"rounded-2 my-5",style:J([{"min-height":"12rem","background-size":"cover","background-position":"center"},`background-image: url('data:image/png;base64, ${o(s).recipeEdit.previewImage||o(s).recipeEdit.image}')`])},null,4),t("div",null,[e(v,{class:"btn primary px-4 py-1 rounded-3 font-s2 mr-3 mb-3"},{default:d(()=>[h(y(o(g)||"Pas de catégorie"),1)]),_:1}),e(v,{class:"btn tertiary px-4 py-1 rounded-3 font-s2"},{default:d(()=>[h(y(o(f)||"Pas de type"),1)]),_:1})]),t("div",fe,[t("div",xe,[e(x,{icon:"ic:outline-access-time",class:"mr-2 text-secondary"}),t("span",null,y(o(s).recipeEdit.preparation_time),1)]),t("div",be,[e(x,{icon:"icon-park-outline:cook",class:"mr-2 text-secondary"}),t("span",null,y(o(s).recipeEdit.cooking_time),1)]),t("div",ge,[e(x,{icon:"mdi:flame",class:"mr-2 text-secondary"}),t("span",null,y(o(s).recipeEdit.difficulty),1)]),t("div",ve,[e(x,{icon:"mdi:users-group",class:"mr-2 text-secondary"}),t("span",null,y(o(s).recipeEdit.eaters_amount),1)])]),t("p",ye,y(o(s).recipeEdit.description),1),ke,Ve,(_(!0),b(S,null,R(o(s).recipeEdit.ingredients,p=>(_(),b("div",{key:p.id,class:"mt-5"},[t("p",Ee,y(p.product_name),1),t("p",he,[t("span",null,y(p.amount),1),t("span",null,y(p.unit),1)])]))),128)),$e,Te,(_(!0),b(S,null,R(o(s).recipeEdit.instructions,p=>(_(),b("div",Ce,[t("p",Ie,y(p.title),1),t("p",we,y(p.description),1)]))),256)),e(v,{disabled:!o(a).isValid,onClick:r,class:"mt-3 d-block mx-auto rounded-2 primary rounded-3 px-4 py-1"},{default:d(()=>[h("Valider")]),_:1},8,["disabled"])]),t("div",Ue,[t("p",{class:k(["font-s4",o(a).isValid?"text-green":"text-red"])},[h(" Recette "+y(o(a).isValid?"valide":"invalide")+" ",1),o(a).isValid?(_(),b("span",Oe,"👌")):(_(),b("span",Se,"🥲"))],2),t("p",{class:k(["cursor-pointer mb-0",o(a).recipeNameOk?"text-green":"text-red"]),onClick:n[0]||(n[0]=p=>c("tab1"))},"Nom",2),t("p",{class:k(["cursor-pointer mb-0",o(a).recipeDescriptionOk?"text-green":"text-red"]),onClick:n[1]||(n[1]=p=>c("tab1"))},"Description",2),t("p",{class:k(["cursor-pointer mb-0",o(a).recipePreparationTimeOk?"text-green":"text-red"]),onClick:n[2]||(n[2]=p=>c("tab1"))},"Tps de préparation",2),t("p",{class:k(["cursor-pointer mb-0",o(a).recipeCookingTimeOk?"text-green":"text-red"]),onClick:n[3]||(n[3]=p=>c("tab1"))},"Tps de cuisson",2),t("p",{class:k(["cursor-pointer mb-0",o(a).difficultyOk?"text-green":"text-red"]),onClick:n[4]||(n[4]=p=>c("tab1"))},"Difficulté",2),t("p",{class:k(["cursor-pointer mb-0",o(a).eatersAmountOk?"text-green":"text-red"]),onClick:n[5]||(n[5]=p=>c("tab1"))},"Nbr de personnes",2),t("p",{class:k(["cursor-pointer mb-0",o(a).categoryOk?"text-green":"text-red"]),onClick:n[6]||(n[6]=p=>c("tab1"))},"Catégorie",2),t("p",{class:k(["cursor-pointer mb-0",o(a).typeOk?"text-green":"text-red"]),onClick:n[7]||(n[7]=p=>c("tab1"))},"Type",2),t("p",{class:k(["cursor-pointer mb-0",o(a).ingredientsNotEmpty?"text-green":"text-red"]),onClick:n[8]||(n[8]=p=>c("tab2"))},"Ingrédients qté / unité",2),t("p",{class:k(["cursor-pointer mb-0",o(a).ingredientsOk?"text-green":"text-red"]),onClick:n[9]||(n[9]=p=>c("tab2"))},"Ingrédients valides",2),t("p",{class:k(["cursor-pointer mb-0",o(a).instructionsNotEmpty?"text-green":"text-red"]),onClick:n[10]||(n[10]=p=>c("tab3"))},"Instructions remplies",2),t("p",{class:k(["cursor-pointer mb-0",o(a).instructionsOk?"text-green":"text-red"]),onClick:n[11]||(n[11]=p=>c("tab3"))},"Instructions valides",2)])])}}}),Ne=C({__name:"RecipeEdit",setup(I){const l=T(),s=w(),E=K(),V=c=>{l.value=c};return Q(async()=>{s.recipeEdit.id||await s.editRecipe(E.params.id)}),(c,g)=>{const f=u("ax-tab-link"),a=u("ax-tab-item"),r=u("ax-tab");return _(),H(r,{modelValue:l.value,"onUpdate:modelValue":g[0]||(g[0]=i=>l.value=i),class:"shadow-1 h100 px-5 pt-2"},{menu:d(()=>[e(f,{href:"#tab1"},{default:d(()=>[h("Général")]),_:1}),e(f,{href:"#tab2"},{default:d(()=>[h("Ingrédients")]),_:1}),e(f,{href:"#tab3"},{default:d(()=>[h("Instructions")]),_:1}),e(f,{href:"#tab4"},{default:d(()=>[h("Aperçu")]),_:1})]),default:d(()=>[e(a,{class:"h100 pt-5",id:"tab1"},{default:d(()=>[e(te)]),_:1}),e(a,{class:"h100 pt-5",id:"tab2"},{default:d(()=>[e(re)]),_:1}),e(a,{class:"h100 pt-5",id:"tab3"},{default:d(()=>[e(ue)]),_:1}),e(a,{class:"h100 pt-5",id:"tab4"},{default:d(()=>[e(Re,{onSwitchTab:V})]),_:1}),e(j,{type:"edit"})]),_:1},8,["modelValue"])}}});const De={class:"h100"},ze=C({__name:"Edit",setup(I){return(l,s)=>(_(),b("div",De,[e(Ne)]))}});export{ze as default};
